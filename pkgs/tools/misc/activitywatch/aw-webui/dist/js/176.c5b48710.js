"use strict";(self["webpackChunkaw_webui"]=self["webpackChunkaw_webui"]||[]).push([[176,96],{97096:(t,e,r)=>{r.r(e),r.d(e,{default:()=>f});let i={};const a={name:"fa-icon",props:{name:{type:String,validator(t){return!t||t in i||(console.warn(`Invalid prop: prop "name" is referring to an unregistered icon "${t}".\nPlease make sure you have imported this icon before using it.`),!1)}},title:String,scale:[Number,String],spin:Boolean,inverse:Boolean,pulse:Boolean,flip:{validator(t){return"horizontal"===t||"vertical"===t}},label:String,tabindex:[Number,String]},data(){return{id:l(),x:!1,y:!1,childrenWidth:0,childrenHeight:0,outerScale:1}},computed:{normalizedScale(){let t=this.scale;return t="undefined"===typeof t?1:Number(t),isNaN(t)||t<=0?(console.warn('Invalid prop: prop "scale" should be a number over 0.',this),this.outerScale):t*this.outerScale},klass(){return{"fa-icon":!0,"fa-spin":this.spin,"fa-flip-horizontal":"horizontal"===this.flip,"fa-flip-vertical":"vertical"===this.flip,"fa-inverse":this.inverse,"fa-pulse":this.pulse,[this.$options.name]:!0}},icon(){return this.name?i[this.name]:null},box(){return this.icon?`0 0 ${this.icon.width} ${this.icon.height}`:`0 0 ${this.width} ${this.height}`},ratio(){if(!this.icon)return 1;let{width:t,height:e}=this.icon;return Math.max(t,e)/16},width(){return this.childrenWidth||this.icon&&this.icon.width/this.ratio*this.normalizedScale||0},height(){return this.childrenHeight||this.icon&&this.icon.height/this.ratio*this.normalizedScale||0},style(){return 1!==this.normalizedScale&&{fontSize:this.normalizedScale+"em"}},raw(){if(!this.icon||!this.icon.raw)return null;let t=this.icon.raw,e={};return t=t.replace(/\s(?:xml:)?id=(["']?)([^"')\s]+)\1/g,((t,r,i)=>{let a=l();return e[i]=a,` id="${a}"`})),t=t.replace(/#(?:([^'")\s]+)|xpointer\(id\((['"]?)([^')]+)\2\)\))/g,((t,r,i,a)=>{let s=r||a;return s&&e[s]?`#${e[s]}`:t})),t},focusable(){let{tabindex:t}=this;if(null==t)return"false";let e="string"===typeof t?parseInt(t,10):t;return e>=0?null:"false"}},mounted(){this.updateStack()},updated(){this.updateStack()},methods:{updateStack(){if(!this.name&&null!==this.name&&0===this.$children.length)return void console.warn('Invalid prop: prop "name" is required.');if(this.icon)return;let t=0,e=0;this.$children.forEach((r=>{r.outerScale=this.normalizedScale,t=Math.max(t,r.width),e=Math.max(e,r.height)})),this.childrenWidth=t,this.childrenHeight=e,this.$children.forEach((r=>{r.x=(t-r.width)/2,r.y=(e-r.height)/2}))}},render(t){if(null===this.name)return t();let e={class:this.klass,style:this.style,attrs:{role:this.$attrs.role||(this.label||this.title?"img":null),"aria-label":this.label||null,"aria-hidden":String(!(this.label||this.title)),tabindex:this.tabindex,x:this.x,y:this.y,width:this.width,height:this.height,viewBox:this.box,focusable:this.focusable}},r=`vat-${this.id}`;if(this.title&&(e.attrs["aria-labelledby"]=r),this.raw){let t=this.raw;this.title&&(t=`<title id="${r}">${h(this.title)}</title>${t}`),e.domProps={innerHTML:t}}let i=this.title?[t("title",{attrs:{id:r}},this.title)]:[];return t("svg",e,this.raw?null:i.concat(this.$slots.default||[...this.icon.paths.map(((e,r)=>t("path",{attrs:e,key:`path-${r}`}))),...this.icon.polygons.map(((e,r)=>t("polygon",{attrs:e,key:`polygon-${r}`})))]))},register(t){for(let e in t){let r=t[e],{paths:a=[],d:n,polygons:l=[],points:o}=r;n&&a.push({d:n}),o&&l.push({points:o}),i[e]=s({},r,{paths:a,polygons:l})}},icons:i};function s(t,...e){return e.forEach((e=>{for(let r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})),t}let n=870711;function l(){return`va-${(n++).toString(16)}`}const o={"<":"&lt;",">":"&gt;",'"':"&quot;","&":"&amp;"};function h(t){return t.replace(/[<>"&]/g,(t=>o[t]||t))}const c=a;var u,d,p=r(1001),g=(0,p.Z)(c,u,d,!1,null,null,null);const f=g.exports},36176:(t,e,r)=>{r.r(e),r.d(e,{default:()=>x});var i=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",[r("h3",[t._v("Alerts")]),r("b-alert",{staticStyle:{},attrs:{show:""}},[t._v("This feature is still in early development.")]),t.error?r("b-alert",{attrs:{show:"",variant:"danger"}},[t._v(t._s(t.error))]):t._e(),t._l(t.alerts,(function(e){return r("b-card",{key:e.name},[r("b-button",{staticClass:"float-right",attrs:{size:"sm",variant:"outline-danger"},on:{click:function(r){return t.deleteAlert(e.name)}}},[r("icon",{attrs:{name:"trash"}})],1),r("div",[t._v("Goal name: "+t._s(e.name))]),r("div",[t._v("Category: "+t._s(e.category.join(" > ")))]),r("div",[t._v("Current: "+t._s(t._f("friendlyduration")(t.alertTime(e.category)))+" / "+t._s(e.goal)+" minutes"),t.alertTime(e.category)>=e.goal?r("span",[r("icon",{staticStyle:{color:"#0C0"},attrs:{name:"check"}})],1):r("span",[r("icon",{attrs:{name:"times",color:"#555"}})],1)])],1)})),r("b-input-group",{staticClass:"mt-3"},[r("b-btn",{attrs:{variant:"success"},on:{click:t.check}},[t._v("Check")]),r("b-input-group-append",[r("b-form-checkbox",{staticClass:"my-2 ml-3",attrs:{switch:""},on:{change:t.toggleAutoRefresh},model:{value:t.autorefresh,callback:function(e){t.autorefresh=e},expression:"autorefresh"}},[t._v("Toggle autorefresh every 10s")])],1)],1),t.last_updated?r("small",[t._v("Last updated: "+t._s(t.last_updated))]):t._e(),r("hr"),r("div",[r("h4",[t._v("New alert")]),r("b-form-group",{attrs:{label:"Name","label-cols-md":"2"}},[r("b-input",{model:{value:t.editing_alert.name,callback:function(e){t.$set(t.editing_alert,"name",e)},expression:"editing_alert.name"}})],1),r("b-form-group",{attrs:{label:"Category","label-cols-md":"2"}},[r("b-select",{model:{value:t.editing_alert.category,callback:function(e){t.$set(t.editing_alert,"category",e)},expression:"editing_alert.category"}},t._l(t.categories,(function(e){return r("option",{domProps:{value:e.value}},[t._v(t._s(e.text))])})),0)],1),r("b-form-group",{attrs:{label:"Goal","label-cols-md":"2"}},[r("b-input-group",{attrs:{append:"minutes"}},[r("b-input",{attrs:{type:"number"},model:{value:t.editing_alert.goal,callback:function(e){t.$set(t.editing_alert,"goal",e)},expression:"editing_alert.goal"}})],1)],1),r("div",[r("b-btn",{attrs:{variant:"success"},on:{click:t.addAlert}},[r("icon",{attrs:{name:"plus"}}),t._v("Add alert")],1)],1)],1)],2)},a=[],s=r(8959),n=r(63360),l=r(32572),o=r(73303),h=r.n(o),c=r(7739),u=r.n(c),d=r(35161),p=r.n(d),g=(r(35666),r(69720),r(23157),r(69600),r(92222),r(57327),r(41539),r(68309),r(32564),r(21249),r(74916),r(23123),r(73210),r(38559),r(83710),r(30381)),f=r.n(g),m=r(78050),v=r(9740),b=(r(46125),r(97096));b["default"].register({check:{width:512,height:512,paths:[{d:"M173.9 439.4l-166.4-166.4c-10-10-10-26.2 0-36.2l36.2-36.2c10-10 26.2-10 36.2 0l112.1 112.1 240.1-240.1c10-10 26.2-10 36.2 0l36.2 36.2c10 10 10 26.2 0 36.2l-294.4 294.4c-10 10-26.2 10-36.2 0z"}]}});r(14169),r(96886);const _={name:"Alerts",data:function(){return{alerts:[{name:"Work",category:["Work"],goal:100},{name:"Media",category:["Media"],goal:10}],editing_alert:{},alert_times:{},error:"",hostnames:[],hostname:"",last_updated:null,autorefresh:!1,running_interval:null,show_options:!1,use_regex:!0,filter_afk:!0}},computed:{categories:function(){return this.$store.getters["categories/category_select"](!0)},alertTime:function(){var t=this;return function(e){var r=0;return p()(Object.entries(t.alert_times),(function(t){var i=(0,l.Z)(t,2),a=i[0],s=i[1];a.startsWith(e.join(","))&&(r+=s)})),r}}},mounted:function(){var t=(0,n.Z)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("buckets/ensureBuckets");case 2:return t.next=4,this.$store.dispatch("categories/load");case 4:this.hostnames=this.$store.getters["buckets/getHostnames"],this.hostname=this.hostnames[0];case 6:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),methods:{addAlert:function(){this.alerts=this.alerts.concat((0,s.Z)({},this.editing_alert))},deleteAlert:function(t){this.alerts=this.alerts.filter((function(e){return e.name!==t}))},toggleAutoRefresh:function(){!this.autorefresh||this.running_interval?(console.log("Stopping autorefresh"),clearInterval(this.running_interval),this.autorefresh=!1,this.running_interval=null):(console.log("Starting autorefresh"),this.autorefresh=!0,this.running_interval=setInterval(this.check,1e4))},check:function(){var t=(0,n.Z)(regeneratorRuntime.mark((function t(){var e,r,i,a,s,n,o,c,d;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e=(0,v.loadClassesForQuery)(),r=(0,m.l8)({bid_window:"aw-watcher-window_"+this.hostname,bid_afk:"aw-watcher-afk_"+this.hostname,filter_afk:this.filter_afk,classes:e,filter_classes:null}),r+="; RETURN = events;",i=r.split(";").map((function(t){return t.trim()+";"})),a=f()().subtract(1,"days").startOf("day"),s=f()(a).add(1,"days"),n=[a.format()+"/"+s.format()],t.prev=7,this.status="searching",t.next=11,this.$aw.query(n,i);case 11:o=t.sent,this.events=o[0],this.error="",t.next=21;break;case 16:return t.prev=16,t.t0=t["catch"](7),console.error(t.t0),this.error=t.t0.response.data.message,t.abrupt("return");case 21:return t.prev=21,this.status=null,t.finish(21);case 24:c=u()(this.events,(function(t){return t.data.$category})),d=Object.fromEntries(p()(Object.entries(c),(function(t){var e=(0,l.Z)(t,2),r=e[0],i=e[1];return[r.split(","),h()(i,"duration")]}))),this.alert_times=d,this.last_updated=new Date;case 28:case"end":return t.stop()}}),t,this,[[7,16,21,24]])})));function e(){return t.apply(this,arguments)}return e}()}},w=_;var y=r(1001),k=(0,y.Z)(w,i,a,!1,null,"cd93afb4",null);const x=k.exports},46125:(t,e,r)=>{var i=r(97096);i["default"].register({plus:{width:448,height:512,paths:[{d:"M416 208c17.7 0 32 14.3 32 32v32c0 17.7-14.3 32-32 32h-144v144c0 17.7-14.3 32-32 32h-32c-17.7 0-32-14.3-32-32v-144h-144c-17.7 0-32-14.3-32-32v-32c0-17.7 14.3-32 32-32h144v-144c0-17.7 14.3-32 32-32h32c17.7 0 32 14.3 32 32v144h144z"}]}})},14169:(t,e,r)=>{var i=r(97096);i["default"].register({times:{width:352,height:512,paths:[{d:"M242.7 256l100.1 100.1c12.3 12.3 12.3 32.2 0 44.5l-22.2 22.2c-12.3 12.3-32.2 12.3-44.5 0l-100.1-100.1-100.1 100.1c-12.3 12.3-32.2 12.3-44.5 0l-22.2-22.2c-12.3-12.3-12.3-32.2 0-44.5l100.1-100.1-100.1-100.1c-12.3-12.3-12.3-32.2 0-44.5l22.2-22.2c12.3-12.3 32.2-12.3 44.5 0l100.1 100.1 100.1-100.1c12.3-12.3 32.2-12.3 44.5 0l22.2 22.2c12.3 12.3 12.3 32.2 0 44.5z"}]}})},96886:(t,e,r)=>{var i=r(97096);i["default"].register({trash:{width:448,height:512,paths:[{d:"M432 32c8.8 0 16 7.2 16 16v32c0 8.8-7.2 16-16 16h-416c-8.8 0-16-7.2-16-16v-32c0-8.8 7.2-16 16-16h120l9.4-18.7c3.6-7.3 13.1-13.3 21.3-13.3h0.1 114.3 0c8.2 0 17.8 6 21.5 13.3l9.4 18.7h120zM53.2 467l-21.2-339h384l-21.2 339c-1.6 24.8-23 45-47.9 45h-245.8c-24.9 0-46.3-20.2-47.9-45z"}]}})}}]);
//# sourceMappingURL=176.c5b48710.js.map